<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>𝕮𝖚𝖘𝖙𝖔𝖒 𝖌𝖊𝖆𝖗𝖘</title>
  <meta name="description" content="Custom Gears - Acessórios personalizados para carros e estilo streetwear.">
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* CSS permanece igual */
  </style>
</head>
<body>
  <div class="cart" onclick="toggleCartPopup()">
    🛒 Carrinho <span class="cart-count" id="cartCount">0</span>
  </div>
  <header>Custom Gears</header>
  <div class="container">
    <h2>Produtos</h2>
    <div class="products" id="productList"></div>
  </div>
  <footer><!-- Sobre e contato --></footer>
  <div class="cart-popup" id="cartPopup"><!-- Popup carrinho --></div>
  <button onclick="scrollToTop()" id="btnTop">↑</button>  <script>
    const products = [
      {
        id: 1,
        name: 'Camiseta oversized Custom Gears',
        basePrice: 119.90,
        priceAdjust: { P: -10, M: 0, G: 10, GG: 15, XG: 20 },
        img: 'https://i.postimg.cc/G3zD0FLD/camisa1.jpg',
        colors: ['Branco','Preto','Cinza','Roxo'],
        sizes: ['P','M','G','GG','XG']
      },
      {
        id: 2,
        name: 'Blusa moletom com capuz Custom Gears',
        basePrice: 159.90,
        priceAdjust: { P: -15, M: 0, G: 20, GG: 25, XG: 30 },
        img: 'https://i.postimg.cc/dtZXDB2x/manopla1.jpg',
        colors: ['Branco','Preto','Cinza','Roxo'],
        sizes: ['P','M','G','GG','XG']
      },
      // ... demais produtos com priceAdjust ...
    ];

    function loadInventory() {
      const saved = localStorage.getItem('inventory');
      if (saved) return JSON.parse(saved);
      const inv = {};
      products.forEach(p => {
        inv[p.id] = {};
        p.colors.forEach(c => p.sizes.forEach(s => inv[p.id][`${c}|${s}`] = 5));
      });
      localStorage.setItem('inventory', JSON.stringify(inv));
      return inv;
    }

    function saveInventory() {
      localStorage.setItem('inventory', JSON.stringify(inventory));
    }

    const inventory = loadInventory();
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function calculatePrice(p, size) {
      const adjust = p.priceAdjust[size] || 0;
      return (p.basePrice + adjust).toFixed(2);
    }

    function renderProducts() {
      const container = document.getElementById('productList');
      container.innerHTML = '';
      products.forEach(p => {
        const card = document.createElement('div'); card.className='product'; card.id=`prod-${p.id}`;
        const keys = Object.keys(inventory[p.id]).filter(k=>inventory[p.id][k]>0);
        if (!keys.length) {
          card.innerHTML = `<img src="${p.img}" alt="${p.name}"/><h3>${p.name}</h3><span class="sold-out-text">Esgotado</span>`;
        } else {
          const colors = [...new Set(keys.map(k=>k.split('|')[0]))];
          const sizes = [...new Set(keys.map(k=>k.split('|')[1]))];
          const initialSize = sizes[0];
          const price = calculatePrice(p, initialSize);
          card.innerHTML = `
            <img src="${p.img}" alt="${p.name}"/>
            <h3>${p.name}</h3>
            <p class="price-label">R$${price}</p>
            <p class="stock-label">Estoque: ${inventory[p.id][`${colors[0]}|${initialSize}`]}</p>
            <label>Cor:<select id="cor-${p.id}">${colors.map(c=>`<option>${c}</option>`).join('')}</select></label><br>
            <label>Tamanho:<select id="tam-${p.id}">${sizes.map(s=>`<option>${s}</option>`).join('')}</select></label><br>
            <button onclick="addToCart(${p.id})">Adicionar ao Carrinho</button>
          `;
        }
        container.appendChild(card);
      });
    }

    function updateStockAndPrice() {
      products.forEach(p => {
        const card = document.getElementById(`prod-${p.id}`);
        const corSel = card.querySelector(`#cor-${p.id}`);
        const tamSel = card.querySelector(`#tam-${p.id}`);
        if (!corSel || !tamSel) return;
        // atualizar estoque
        const key = `${corSel.value}|${tamSel.value}`;
        const stock = inventory[p.id][key] || 0;
        card.querySelector('.stock-label').textContent = `Estoque: ${stock}`;
        // atualizar botão
        const btn = card.querySelector('button');
        if (stock<=0) { btn.textContent='Esgotado'; btn.disabled=true; }
        else { btn.textContent='Adicionar ao Carrinho'; btn.disabled=false; }
        // atualizar preço
        const newPrice = calculatePrice(p, tamSel.value);
        card.querySelector('.price-label').textContent = `R$${newPrice}`;
      });
    }

    function addToCart(id) {
      const cor = document.getElementById(`cor-${id}`).value;
      const tam = document.getElementById(`tam-${id}`).value;
      const key = `${cor}|${tam}`;
      if (inventory[id][key] <= 0) return;
      inventory[id][key]--;
      saveInventory();
      updateStockAndPrice();
      const exists = cart.find(i=>i.id===id&&i.cor===cor&&i.tam===tam);
      if (exists) exists.quantity++;
      else cart.push({id, cor, tam, quantity:1});
      localStorage.setItem('cart', JSON.stringify(cart));
      document.getElementById('cartCount').textContent = cart.reduce((a,i)=>a+i.quantity,0);
    }

    // funções do carrinho (toggleCartPopup, renderCartPopup, changeQty, removeFromCart, closeCart, checkout)...

    document.addEventListener('change', e=>{
      if (e.target.tagName==='SELECT') updateStockAndPrice();
    });
    document.addEventListener('DOMContentLoaded', ()=>{
      renderProducts();
      updateStockAndPrice();
      document.getElementById('cartCount').textContent = cart.reduce((a,i)=>a+i.quantity,0);
    });
  </script></body>
</html>
