<script>
  const products = [
    { nome: 'Camiseta JDM', preco: 89.90, imagem: 'https://via.placeholder.com/250x250.png?text=Camiseta+JDM' },
    { nome: 'Boné Street', preco: 59.90, imagem: 'https://via.placeholder.com/250x250.png?text=Boné+Street' },
    { nome: 'Chaveiro costumizado', preco: 29.90, imagem: 'https://via.placeholder.com/250x250.png?text=Chaveiro+Turbo' },
    { nome: 'Parafusos e Engrenagem', preco: 24.90, imagem: 'https://via.placeholder.com/250x250.png?text=Chaveiro+Engrenagem' },
    { nome: 'Bancos Concha', preco: 799.90, imagem: 'https://via.placeholder.com/250x250.png?text=Bancos+Concha' },
    { nome: 'Adesivos Reflectivos', preco: 14.90, imagem: 'https://via.placeholder.com/250x250.png?text=Adesivo+Reflectivo' }
  ];

  let cart = {};

  function renderProducts() {
    const container = document.getElementById('productList');
    container.innerHTML = '';
    products.forEach((product, index) => {
      container.innerHTML += `
        <div class="product">
          <img src="${product.imagem}" alt="${product.nome}">
          <h3>${product.nome}</h3>
          <p>R$ ${product.preco.toFixed(2)}</p>
          <button onclick="addToCart(${index})">Adicionar ao carrinho</button>
        </div>`;
    });
  }

  function addToCart(index) {
    const key = index.toString();
    if (cart[key]) {
      cart[key].quantidade += 1;
    } else {
      cart[key] = { ...products[index], quantidade: 1 };
    }
    updateCartCount();
    renderCartItems();
  }

  function updateCartCount() {
    let totalItems = Object.values(cart).reduce((sum, item) => sum + item.quantidade, 0);
    document.getElementById('cartCount').textContent = totalItems;
    updateCartTotal();
  }

  function updateCartTotal() {
    let total = Object.values(cart).reduce((acc, item) => acc + (item.preco * item.quantidade), 0);
    document.getElementById('cartTotal').textContent = total.toFixed(2);
  }

  function toggleCartPopup() {
    const popup = document.getElementById('cartPopup');
    if (Object.keys(cart).length === 0) {
      alert("Seu carrinho está vazio.");
      return;
    }
    popup.style.display = popup.style.display === 'flex' ? 'none' : 'flex';
    renderCartItems();
  }

  function renderCartItems() {
    const list = document.getElementById('cartItemsList');
    list.innerHTML = '';
    Object.entries(cart).forEach(([key, item]) => {
      list.innerHTML += `
        <li>
          ${item.nome} (x${item.quantidade}) - R$ ${(item.preco * item.quantidade).toFixed(2)} 
          <button onclick="removeFromCart('${key}')">Remover</button>
        </li>`;
    });
  }

  function removeFromCart(index) {
    if (cart[index]) {
      cart[index].quantidade -= 1;
      if (cart[index].quantidade <= 0) {
        delete cart[index];
      }
    }
    updateCartCount();
    renderCartItems();
  }

  function checkout() {
    document.getElementById('checkoutForm').style.display = 'block';
    document.getElementById('cartPopup').style.display = 'none';
  }

  function submitOrder(event) {
    event.preventDefault();

    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const address = document.getElementById('address').value;

    document.getElementById('checkoutForm').style.display = 'none';
    document.getElementById('orderSummary').style.display = 'block';

    document.getElementById('clientInfo').innerHTML = `<strong>Cliente:</strong> ${name}<br><strong>Email:</strong> ${email}<br><strong>Endereço:</strong> ${address}`;

    const orderList = document.getElementById('orderItems');
    orderList.innerHTML = '';

    let total = 0;
    Object.values(cart).forEach(item => {
      orderList.innerHTML += `<li>${item.nome} (x${item.quantidade}) - R$ ${(item.preco * item.quantidade).toFixed(2)}</li>`;
      total += item.preco * item.quantidade;
    });

    document.getElementById('summaryTotal').textContent = total.toFixed(2);
    cart = {};
    updateCartCount();
    return false;
  }

  renderProducts();
</script>
